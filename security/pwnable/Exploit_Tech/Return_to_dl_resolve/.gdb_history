disas main
pd main
ropgadge
ropgadget
q
peda vuln
pd vuln
q
shell readelf -S rop
x/4i 0x80482f0
x/wx 0x804a004
x/4i 0x80482f0
q
q
pd main
q
b *main
r
ropgadget
x/i 0x80484e9
q
i r 
pd main
pd vuln
q
i b
q
readelf 
readelf .plt
readelf plt
x/i 0x80482f0
0x804a004
x/wx 0x804a004
x/wx 0x804a008
x/20i 0x804a008
x/20i 0xf7701000
q
c
q
i b
pd main
pd vuln
checksec
i r
i r ebp
x/wx 0xffdf6c28
x/wx 0xffdf6c38
ni
x/wx $esp
x/wx $ebp
x/i 0x08048300
ni
q
ni
1
123
q
ni
c
c
c
q
c
c
p system
b *0xf75d5da0
c
i r
q
pd vuln
q
q
c
c
x/wx 0x804a020+0x300
x/10wx 0x804a020+0x300
x/50wx 0x804a020+0x300
readelf
p 0x80482b0+0x2084
x/wx 0x80482b0+0x2084
q
q
ni
si
ni
si
b *_dl_lookup_x+1597
pd 
pd do_lookup_x
b *dl_lookup_x+1597
b *do_lookup_x+1597
c
q
c
c
q
c
c
q
c
ni
si
ni
q
ni
c
ni
si
ni
si
ni

pd _dl_lookup_symbol_x+48
x/i _dl_lookup_symbol_x+48
b *0xf7776a9a
c
q
c
ni
si
ni
si
ni
ni
si
ni
ni
q
c
c
q
q
q
q
