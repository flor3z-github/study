#define _GNU_SOURCE
#include <stdio.h>
#include <unistd.h>
#include <dlfcn.h>

void vuln()
{
	char buf[50];
	void (*printf_addr)() = dlsym(RTLD_NEXT, "printf");
	printf("printf address : %p\n", printf_addr);
	printf("buf[50] address : %p\n", buf);
	read(0, buf, 256);
}

void main()
{
	write(1, "Hello ROP\n", 10);
	vuln();
}
